# Reference links -
https://github.com/aks7777/thoughtworks-vodqa-contract-testing/tree/main/retailer
https://github.com/lovishpahwa/thoughtworks-geeknight-contract-testing/tree/main
https://www.youtube.com/watch?v=yaAe0aR1G-U
https://www.youtube.com/watch?v=84k7jUnWxFM
https://www.youtube.com/watch?v=7QHpEhRI0sQ

# Upgrade java JDK to version 21
https://www.rosehosting.com/blog/how-to-install-java-21-on-ubuntu-24-04/

#  Command to start pactbroker
Go to the project location -
cd /home/suraj/IdeaProjects/contractTesting
sudo docker-compose -f docker-compose-pactbroker.yml up --build
docker-compose -f docker-compose-pactbroker.yml up

sudo docker-compose -f docker-compose-pactbroker.yml up

sudo docker-compose up

# Imp (Link - https://hub.docker.com/r/pactfoundation/pact-broker/)
# (https://github.com/pact-foundation/pact-broker-docker/blob/master/example-k8s-deployment/deployment/common.yaml)
# (https://blog.reinhard.codes/2023/01/02/sharing-contracts-with-pact-broker/)
sudo docker-compose up --force-recreate
# To check if containers are running or not?
sudo docker ps

# Launch pact broker using
http://localhost:9292/

# Maven

# When Plugin Not Properly Included in the Build
mvn clean install
mvn dependency:resolve

# Corrupted Local Maven Repository
rm -rf ~/.m2/repository/au/com/dius/pact
mvn clean install

# Publishing pact files to a pact broker
mvn clean install
mvn pact:publish

# (https://www.baeldung.com/java-lang-unsupportedclassversion)

# To install ruby
sudo snap install ruby  # version 3.3.2, or
sudo apt  install ruby  # version 1:2.7+1

sudo apt install ruby-bundler

# To have a play around on your local machine - Pact Broker
Install ruby 2.2.0 or later and bundler >= 1.12.0
Windows users: get a Rails/Ruby installer from RailsInstaller and run it
unix users just use your package manager
Run git clone git@github.com:pact-foundation/pact_broker.git && cd pact_broker/example
Run bundle install
Run bundle exec rackup -p 8080 (this will use a Sqlite database. If you want to try it out with a Postgres database, see the README in the example directory.)
Open http://localhost:8080 and you should see a list containing the pact between the Zoo App and the Animal Service.
Click on the arrow to see the generated HTML documentation.
Click on either service to see an autogenerated network diagram.
Click on the HAL Browser link to have a poke around the API.
Click on the book icon under "docs" to view documentation related to a given relation.


# To run pact broker with postgres DB
Create a postgres database

psql postgres -c "CREATE DATABASE pact_broker;"
psql postgres -c "CREATE ROLE pact_broker WITH LOGIN PASSWORD 'pact_broker';"
psql postgres -c "GRANT ALL PRIVILEGES ON DATABASE pact_broker TO pact_broker;"
Uncomment gem 'pg' in the Gemfile

Comment out gem 'sqlite3' in the Gemfile

Replace the database_url in config/pact_broker.yml with postgres://pact_broker:pact_broker@<YOUR_DB_HOST>/pact_broker

Install dependencies

bundle install
Run Pact Broker

RACK_ENV=production bundle exec puma
Now Pact Broker can be access locally at http://localhost:9292.


# To run project
mvn -U clean install

To see the full stack trace of the errors, re-run Maven with the -e switch
mvn -U clean install -e

Re-run Maven using the -X switch to enable full debug logging
mvn -U clean install -X



# Git initialization
git init

git add .
or
git add -A

git commit -m 'Added my project'

git remote add origin git@github.com:sammy/my-new-project.git
OR
git remote add origin https://github.com/surajd13195/contractTestingUsingPact.git

git push origin master 
or
git push -u -f origin main

# To create a new repository on the command line
echo "# contractTestUsingPact" >> README.md
git init
git add README.md
git commit -m "first commit"
git branch -M main
git remote add origin https://github.com/surajd13195/consumerDrivenContractTest.git
git push -u origin main

# TO push an existing repository from the command line
git remote add origin https://github.com/surajd13195/consumerDrivenContractTest.git
git branch -M main
git push -u origin main

# Running with Docker Compose
For a quick start with the Pact Broker and Postgres, we have an example Docker Compose‚Å† setup you can use:

Modify the docker-compose.yml file as required.
Run docker-compose build to build the pact_broker container locally.
Run docker-compose up to get a running Pact Broker and a clean Postgres database.
Now you can access your local broker:

curl -v http://localhost # you can visit in your browser too!

# SSL endpoint, note that URLs in response contain https:// protocol
curl -v -k https://localhost:8443
NOTE: this image should be modified before using in Production, in particular, the use of hard-coded credentials